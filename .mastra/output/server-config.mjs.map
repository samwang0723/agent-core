{"version":3,"file":"server-config.mjs","sources":["../../src/mastra/utils/logger.ts","../../src/mastra/tools/remote/mcp.config.ts","../../src/mastra/tools/remote/mcp.service.ts","../../src/mastra/tools/remote/mcp.repository.ts","../../src/mastra/workflows/weather.ts","../../src/mastra/tools/local/weather.ts","../../src/mastra/tools/local/index.ts","../../src/mastra/tools/registry.ts","../../src/mastra/agents/weather.ts","../../src/mastra/agents/websearch.ts","../../src/mastra/models/model.dto.ts","../../src/mastra/models/model.service.ts","../../src/mastra/network/intent.ts","../../src/mastra/auth/google.ts","../../src/mastra/index.ts"],"sourcesContent":["import { IMastraLogger, LoggerTransport, LogLevel } from '@mastra/core/logger';\nimport winston from 'winston';\n\nconst winstonLogger = winston.createLogger({\n  level: process.env.LOG_LEVEL || 'info',\n  format: winston.format.combine(\n    winston.format.timestamp(),\n    winston.format.printf(({ timestamp, level, message, ...rest }) => {\n      const args = Object.keys(rest).length\n        ? JSON.stringify(rest, null, 2)\n        : '';\n      return `${timestamp} ${level}: ${message} ${args}`;\n    })\n  ),\n  transports: [\n    new winston.transports.Console({\n      format: winston.format.combine(\n        winston.format.colorize(),\n        winston.format.printf(({ timestamp, level, message, ...rest }) => {\n          let args = '';\n          if (typeof message === 'object') {\n            args = JSON.stringify(message, null, 2);\n            message = '';\n          }\n          const extraArgs = Object.keys(rest).length\n            ? JSON.stringify(rest, null, 2)\n            : '';\n          return `${timestamp} ${level}: ${message} ${args} ${extraArgs}`.trim();\n        })\n      ),\n    }),\n    new winston.transports.File({ filename: 'error.log', level: 'error' }),\n    new winston.transports.File({ filename: 'combined.log' }),\n  ],\n});\n\nconst logger: IMastraLogger = {\n  info: (message: string, ...args: any[]) =>\n    winstonLogger.info(message, ...args),\n  warn: (message: string, ...args: any[]) =>\n    winstonLogger.warn(message, ...args),\n  error: (message: string | Error, ...args: any[]) => {\n    if (message instanceof Error) {\n      winstonLogger.error(message.message, message, ...args);\n    } else {\n      winstonLogger.error(message, ...args);\n    }\n  },\n  debug: (message: string, ...args: any[]) =>\n    winstonLogger.debug(message, ...args),\n  getTransports: (): Map<string, LoggerTransport> => {\n    return new Map<string, LoggerTransport>();\n  },\n  trackException: (error: {\n    originalError?: Error;\n    message: string;\n    properties?: { [key: string]: any };\n    measurements?: { [key: string]: number };\n  }) => {\n    const err = error.originalError || new Error(error.message);\n    winstonLogger.error(err.message, {\n      stack: err.stack,\n      properties: error.properties,\n      measurements: error.measurements,\n    });\n  },\n  getLogs: async (\n    transportId: string,\n    params?: {\n      fromDate?: Date;\n      toDate?: Date;\n      logLevel?: LogLevel;\n      filters?: Record<string, any>;\n      page?: number;\n      perPage?: number;\n    }\n  ): Promise<{\n    logs: any[];\n    total: number;\n    page: number;\n    perPage: number;\n    hasMore: boolean;\n  }> => {\n    console.log(\n      `Getting logs for transport: ${transportId} with params:`,\n      params\n    );\n    return {\n      logs: [],\n      total: 0,\n      page: params?.page || 1,\n      perPage: params?.perPage || 10,\n      hasMore: false,\n    };\n  },\n  getLogsByRunId: async (args: {\n    transportId: string;\n    runId: string;\n    fromDate?: Date;\n    toDate?: Date;\n    logLevel?: LogLevel;\n    filters?: Record<string, any>;\n    page?: number;\n    perPage?: number;\n  }): Promise<{\n    logs: any[];\n    total: number;\n    page: number;\n    perPage: number;\n    hasMore: boolean;\n  }> => {\n    console.log(`Getting logs for runId: ${args.runId} with params:`, args);\n    return {\n      logs: [],\n      total: 0,\n      page: args.page || 1,\n      perPage: args.perPage || 10,\n      hasMore: false,\n    };\n  },\n};\n\nexport default logger;\n","import { McpServerConfig } from './mcp.dto';\n\nexport const mcpServers: McpServerConfig[] = [\n  {\n    name: 'restaurant-booking',\n    url: process.env.RESTAURANT_BOOKING_MCP_URL || 'http://127.0.0.1:3001/mcp',\n    healthUrl:\n      process.env.RESTAURANT_BOOKING_MCP_HEALTH_URL ||\n      'http://127.0.0.1:3001/health',\n    enabled: process.env.RESTAURANT_BOOKING_MCP_ENABLED !== 'false',\n    requiresAuth: false,\n  },\n  {\n    name: 'time',\n    url: process.env.TIME_MCP_URL || 'http://127.0.0.1:3002/mcp',\n    healthUrl:\n      process.env.TIME_MCP_HEALTH_URL || 'http://127.0.0.1:3002/health',\n    enabled: process.env.TIME_MCP_ENABLED !== 'false',\n    requiresAuth: false,\n  },\n  {\n    name: 'google-assistant',\n    url: process.env.GOOGLE_ASSISTANT_MCP_URL || 'http://127.0.0.1:3003/mcp',\n    healthUrl:\n      process.env.GOOGLE_ASSISTANT_MCP_HEALTH_URL ||\n      'http://127.0.0.1:3003/health',\n    enabled: process.env.GOOGLE_ASSISTANT_MCP_ENABLED !== 'false',\n    requiresAuth: true,\n  },\n  {\n    name: 'web-search',\n    url: process.env.WEB_SEARCH_MCP_URL || 'http://127.0.0.1:3004/mcp',\n    healthUrl:\n      process.env.WEB_SEARCH_MCP_HEALTH_URL || 'http://127.0.0.1:3004/health',\n    enabled: process.env.WEB_SEARCH_MCP_ENABLED !== 'false',\n    requiresAuth: false,\n  },\n  {\n    name: 'atlassian',\n    url: process.env.ALTASIAN_MCP_URL || 'http://127.0.0.1:3005/mcp',\n    healthUrl:\n      process.env.ALTASIAN_MCP_HEALTH_URL || 'http://127.0.0.1:3005/health',\n    enabled: process.env.ALTASIAN_MCP_ENABLED !== 'false',\n    requiresAuth: false,\n  },\n];\n","import { createTool, Tool, ToolExecutionContext } from '@mastra/core/tools';\nimport { z } from 'zod';\nimport logger from '../../utils/logger';\nimport {\n  McpServerConfig,\n  McpTool,\n  JsonRpcResponse,\n  ToolsListResult,\n  ToolCallResult,\n} from './mcp.dto';\nimport { JsonSchema } from './mcp.dto';\n\nexport class McpClient {\n  private sessionId: string | null = null;\n  private availableTools: McpTool[] = [];\n  private accessToken: string | null = null;\n\n  constructor(private config: McpServerConfig) {}\n\n  /**\n   * Set the OAuth access token for authenticated requests\n   */\n  setAccessToken(token: string | null): void {\n    this.accessToken = token;\n  }\n\n  async initialize(): Promise<void> {\n    if (!this.config.enabled) {\n      logger.info(`MCP server ${this.config.name} is disabled`);\n      return;\n    }\n\n    try {\n      await this.healthCheck();\n      await this.initializeSession();\n      await this.loadTools();\n      logger.info(\n        `MCP client for ${this.config.name} initialized with ${this.availableTools.length} tools`\n      );\n    } catch (error) {\n      logger.error(\n        `Failed to initialize MCP client for ${this.config.name}:`,\n        error\n      );\n      throw error;\n    }\n  }\n\n  private async healthCheck(): Promise<void> {\n    if (!this.config.healthUrl) return;\n\n    const response = await fetch(this.config.healthUrl, {\n      signal: AbortSignal.timeout(5000),\n    });\n    if (!response.ok) {\n      throw new Error(`Health check failed: ${response.status}`);\n    }\n  }\n\n  private async initializeSession(): Promise<void> {\n    // Match the exact format from the working test script\n    const response = await fetch(this.config.url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Accept: 'application/json, text/event-stream',\n      },\n      body: JSON.stringify({\n        jsonrpc: '2.0',\n        id: 'init',\n        method: 'initialize',\n        params: {\n          protocolVersion: '2024-11-05',\n          capabilities: { tools: {} },\n          clientInfo: { name: 'agent-swarm', version: '1.0.0' },\n        },\n      }),\n    });\n    logger.info(`Session initialization request: ${this.config.url}`);\n\n    if (!response.ok) {\n      const errorText = await response.text();\n      throw new Error(\n        `Session initialization failed: ${response.status} - ${errorText}`\n      );\n    }\n\n    // Get the full response text to extract session ID (like curl -i)\n    const responseText = await response.text();\n\n    // Extract session ID from headers (check both response headers and response text)\n    this.sessionId = response.headers.get('mcp-session-id');\n    if (!this.sessionId) {\n      // Try to extract from response text if it's in there\n      const sessionMatch = responseText.match(/mcp-session-id:\\s*([^\\s\\r\\n]+)/);\n      this.sessionId = sessionMatch ? sessionMatch[1].trim() : 'default';\n    }\n\n    logger.info(`MCP session initialized: ${this.sessionId}`);\n\n    // Send initialized notification (skip response handling for notification)\n    try {\n      await fetch(this.config.url, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Accept: 'application/json, text/event-stream',\n          'mcp-session-id': this.sessionId,\n        },\n        body: JSON.stringify({\n          jsonrpc: '2.0',\n          method: 'notifications/initialized',\n          params: {},\n        }),\n      });\n    } catch (error) {\n      logger.warn('Failed to send initialized notification:', error);\n      // Don't fail the whole initialization for this\n    }\n  }\n\n  private async loadTools(): Promise<void> {\n    const response = await fetch(this.config.url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Accept: 'application/json, text/event-stream',\n        'mcp-session-id': this.sessionId!,\n      },\n      body: JSON.stringify({\n        jsonrpc: '2.0',\n        method: 'tools/list',\n        id: 'list-tools',\n      }),\n    });\n\n    if (!response.ok) {\n      const errorText = await response.text();\n      throw new Error(\n        `Failed to list tools: ${response.status} - ${errorText}`\n      );\n    }\n\n    // Handle both JSON and SSE responses\n    const responseText = await response.text();\n    const result = this.parseResponse(responseText);\n\n    if (result.error) {\n      throw new Error(`Tools list error: ${result.error.message}`);\n    }\n\n    this.availableTools = (result.result as ToolsListResult)?.tools || [];\n\n    logger.info(\n      `Loaded ${this.availableTools.length} tools from ${this.config.name}:`,\n      this.availableTools.map(t => t.name)\n    );\n  }\n\n  async callTool(\n    name: string,\n    parameters: Record<string, unknown> | ToolExecutionContext<z.ZodType>,\n    requiresAuth?: boolean\n  ): Promise<unknown> {\n    if (!this.sessionId) {\n      throw new Error('MCP session not initialized');\n    }\n\n    // Check if authentication is required\n    const needsAuth =\n      requiresAuth ||\n      this.config.requiresAuth ||\n      this.availableTools.find(t => t.name === name)?.requiresAuth;\n\n    if (needsAuth && !this.accessToken) {\n      throw new Error(\n        `Tool '${name}' requires authentication but no access token provided`\n      );\n    }\n\n    const headers: Record<string, string> = {\n      'Content-Type': 'application/json',\n      Accept: 'application/json, text/event-stream',\n      'mcp-session-id': this.sessionId,\n    };\n\n    // Add authorization header if needed\n    if (needsAuth && this.accessToken) {\n      headers['Authorization'] = `Bearer ${this.accessToken}`;\n    }\n\n    // Handle both raw parameters and ToolExecutionContext\n    const toolParameters =\n      'context' in parameters ? parameters.context : parameters;\n\n    const payload = {\n      jsonrpc: '2.0',\n      method: 'tools/call',\n      params: { name, arguments: toolParameters },\n      id: Date.now(),\n    };\n\n    try {\n      const startTime = Date.now();\n      logger.info(\n        `Calling tool ${name} with parameters: ${JSON.stringify(payload)}, headers: ${JSON.stringify(headers)}`\n      );\n      const response = await fetch(this.config.url, {\n        method: 'POST',\n        headers,\n        body: JSON.stringify(payload),\n        signal: AbortSignal.timeout(\n          parseInt(process.env.MCP_TIMEOUT || '30000')\n        ),\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        const errorMessage = `Tool call failed: ${response.status} ${response.statusText} - ${errorText}`;\n\n        throw new Error(errorMessage);\n      }\n\n      // Handle both JSON and SSE responses\n      const responseText = await response.text();\n\n      const result = this.parseResponse(responseText);\n      const endTime = Date.now();\n      const duration = endTime - startTime;\n      logger.info(\n        `Tool call result: ${JSON.stringify(result).slice(0, 200)}... in ${duration}ms`\n      );\n\n      if (result.error) {\n        const errorMessage = `Tool execution error: ${result.error.message}`;\n        throw new Error(errorMessage);\n      }\n\n      // Handle MCP response format\n      const toolCallResult = result.result as ToolCallResult;\n      if (toolCallResult?.content?.[0]?.type === 'text') {\n        const text = toolCallResult.content[0].text;\n        try {\n          return JSON.parse(text);\n        } catch {\n          return text;\n        }\n      }\n\n      return result.result;\n    } catch (error: unknown) {\n      if (\n        error instanceof Error &&\n        (error.name === 'TimeoutError' || error.name === 'AbortError')\n      ) {\n        const timeout = parseInt(process.env.MCP_TIMEOUT || '30000') / 1000;\n        const errorMessage = `The tool call to '${name}' timed out after ${timeout} seconds. Please try again later.`;\n\n        logger.error(errorMessage);\n        return {\n          error: errorMessage,\n        };\n      }\n\n      throw error;\n    }\n  }\n\n  getAvailableTools(): Tool<z.ZodType>[] {\n    return this.availableTools.map(mcpTool => {\n      const zodSchema = this.convertInputSchemaToZod(mcpTool.inputSchema);\n\n      return createTool({\n        id: mcpTool.name,\n        description: mcpTool.description,\n        inputSchema: zodSchema,\n        execute: async parameters => {\n          return await this.callTool(\n            mcpTool.name,\n            parameters,\n            mcpTool.requiresAuth\n          );\n        },\n      });\n    });\n  }\n\n  private convertInputSchemaToZod(schema: JsonSchema): z.ZodType {\n    if (!schema || !schema.type) {\n      // Return a default schema if the input is invalid\n      return z.any();\n    }\n\n    switch (schema.type) {\n      case 'object': {\n        const shape: z.ZodRawShape = {};\n        if (schema.properties) {\n          for (const key of Object.keys(schema.properties)) {\n            const prop = schema.properties[key];\n            let zodType = this.convertInputSchemaToZod(prop).describe(\n              prop.description || ''\n            );\n\n            if (!schema.required?.includes(key)) {\n              zodType = zodType.optional();\n            }\n            shape[key] = zodType;\n          }\n        }\n        return z.object(shape);\n      }\n      case 'string':\n        return z.string().describe(schema.description || '');\n      case 'number':\n      case 'integer':\n        return z.number().describe(schema.description || '');\n      case 'boolean':\n        return z.boolean().describe(schema.description || '');\n      case 'array':\n        if (schema.items) {\n          return z\n            .array(this.convertInputSchemaToZod(schema.items))\n            .describe(schema.description || '');\n        }\n        return z.array(z.any()).describe(schema.description || ''); // Fallback for arrays with no item schema\n      default:\n        return z.any(); // Fallback for unknown types\n    }\n  }\n\n  getToolNames(): string[] {\n    return this.availableTools.map(t => t.name);\n  }\n\n  private parseResponse(responseText: string): JsonRpcResponse {\n    try {\n      // Handle JSON-RPC response\n      if (responseText.trim().startsWith('{')) {\n        return JSON.parse(responseText);\n      }\n\n      // Handle Server-Sent Events (SSE) stream\n      const lines = responseText\n        .trim()\n        .split('\\n')\n        .filter(line => line.startsWith('data: '));\n\n      if (lines.length > 0) {\n        // In case of multiple data lines, we might need to decide how to handle them.\n        // For now, parsing the last one as it's most likely the final result.\n        const lastLine = lines[lines.length - 1];\n        const jsonData = lastLine.substring(5).trim();\n        return JSON.parse(jsonData);\n      }\n\n      // Fallback for unexpected format\n      throw new Error('Invalid response format');\n    } catch (error) {\n      logger.error('Failed to parse MCP response:', {\n        responseText,\n        error,\n      });\n      // Ensure a consistent error format\n      return {\n        jsonrpc: '2.0',\n        id: null,\n        error: {\n          code: -32700, // Parse error\n          message: 'Failed to parse response',\n          data: responseText,\n        },\n      };\n    }\n  }\n}\n","import { Tool } from '@mastra/core';\nimport { McpServerConfig } from './mcp.dto';\nimport { McpClient } from './mcp.service';\nimport logger from '../../utils/logger';\nimport { z } from 'zod';\n\nexport class McpRegistry {\n  private clients: Map<string, McpClient> = new Map();\n  private allTools: Map<string, Tool<z.ZodType>> = new Map();\n  private toolsByServer: Map<string, Map<string, Tool<z.ZodType>>> = new Map();\n\n  constructor(private configs: McpServerConfig[]) {}\n\n  async initialize(): Promise<void> {\n    const initPromises = this.configs.map(config =>\n      this.initializeClient(config)\n    );\n\n    // Initialize all clients in parallel\n    const results = await Promise.allSettled(initPromises);\n\n    // Log results\n    results.forEach((result, index) => {\n      const config = this.configs[index];\n      if (result.status === 'rejected') {\n        logger.error(\n          `Failed to initialize MCP client for ${config.name}:`,\n          result.reason\n        );\n      }\n    });\n\n    logger.info(\n      `MCP Registry initialized with ${this.clients.size} active clients and ${this.allTools.size} total tools`\n    );\n  }\n\n  private async initializeClient(config: McpServerConfig): Promise<void> {\n    if (!config.enabled) {\n      logger.info(`Skipping disabled MCP server: ${config.name}`);\n      return;\n    }\n\n    try {\n      const client = new McpClient(config);\n      await client.initialize();\n\n      this.clients.set(config.name, client);\n\n      // Initialize server-specific tools map\n      const serverTools = new Map<string, Tool<z.ZodType>>();\n      this.toolsByServer.set(config.name, serverTools);\n\n      // Register all tools from this client\n      const tools = client.getAvailableTools();\n      const toolNames = client.getToolNames();\n\n      tools.forEach((tool, index) => {\n        const toolName = toolNames[index];\n\n        if (this.allTools.has(toolName)) {\n          logger.warn(\n            `Tool name collision: Tool '${toolName}' from server '${config.name}' is overwriting a previously registered tool.`\n          );\n        }\n\n        // Store in flattened map without prefix\n        this.allTools.set(toolName, tool);\n\n        // Store in server-specific map without prefix\n        serverTools.set(toolName, tool);\n      });\n\n      logger.info(`Registered ${tools.length} tools from ${config.name}`);\n    } catch (error) {\n      logger.error(\n        `Failed to initialize MCP client for ${config.name}:`,\n        error\n      );\n      throw error;\n    }\n  }\n\n  /**\n   * Get all registered tools as a flattened object with prefixed names\n   */\n  getTools(): Record<string, Tool<z.ZodType>> {\n    const toolsObject: Record<string, Tool<z.ZodType>> = {};\n    this.allTools.forEach((tool, name) => {\n      toolsObject[name] = tool;\n    });\n    return toolsObject;\n  }\n\n  /**\n   * Get tools grouped by MCP server name\n   */\n  getToolsByServerMap(): Record<string, Record<string, Tool<z.ZodType>>> {\n    const serverToolsObject: Record<\n      string,\n      Record<string, Tool<z.ZodType>>\n    > = {};\n\n    this.toolsByServer.forEach((tools, serverName) => {\n      const toolsObject: Record<string, Tool<z.ZodType>> = {};\n      tools.forEach((tool, toolName) => {\n        toolsObject[toolName] = tool;\n      });\n      serverToolsObject[serverName] = toolsObject;\n    });\n\n    return serverToolsObject;\n  }\n\n  /**\n   * Get tools from a specific MCP server as objects\n   */\n  getServerTools(serverName: string): Record<string, Tool<z.ZodType>> {\n    const serverTools = this.toolsByServer.get(serverName);\n    if (!serverTools) {\n      return {};\n    }\n\n    const toolsObject: Record<string, Tool<z.ZodType>> = {};\n    serverTools.forEach((tool, toolName) => {\n      toolsObject[toolName] = tool;\n    });\n    return toolsObject;\n  }\n\n  /**\n   * Get tool names from a specific MCP server\n   */\n  getServerToolNames(serverName: string): string[] {\n    const serverTools = this.toolsByServer.get(serverName);\n    return serverTools ? Array.from(serverTools.keys()) : [];\n  }\n\n  /**\n   * Get a specific tool by name\n   */\n  getTool(name: string): Tool<z.ZodType> | undefined {\n    return this.allTools.get(name);\n  }\n\n  /**\n   * Get a specific tool from a specific server\n   */\n  getServerTool(\n    serverName: string,\n    toolName: string\n  ): Tool<z.ZodType> | undefined {\n    const serverTools = this.toolsByServer.get(serverName);\n    return serverTools?.get(toolName);\n  }\n\n  /**\n   * Check if a tool exists\n   */\n  hasTool(name: string): boolean {\n    return this.allTools.has(name);\n  }\n\n  /**\n   * Check if a server has a specific tool\n   */\n  hasServerTool(serverName: string, toolName: string): boolean {\n    const serverTools = this.toolsByServer.get(serverName);\n    return serverTools?.has(toolName) ?? false;\n  }\n\n  /**\n   * Get tool names\n   */\n  getToolNames(): string[] {\n    return Array.from(this.allTools.keys());\n  }\n\n  /**\n   * Get available MCP server names\n   */\n  getServerNames(): string[] {\n    return Array.from(this.toolsByServer.keys());\n  }\n\n  /**\n   * Get status of all MCP clients\n   */\n  getStatus(): Record<string, { connected: boolean; toolCount: number }> {\n    const status: Record<string, { connected: boolean; toolCount: number }> =\n      {};\n\n    this.configs.forEach(config => {\n      const client = this.clients.get(config.name);\n      const serverTools = this.toolsByServer.get(config.name);\n      status[config.name] = {\n        connected: !!client,\n        toolCount: serverTools ? serverTools.size : 0,\n      };\n    });\n\n    return status;\n  }\n\n  /**\n   * Set access token for all MCP clients that require authentication\n   */\n  setAccessTokenForAll(accessToken: string | null): void {\n    this.clients.forEach((client, serverName) => {\n      const config = this.configs.find(c => c.name === serverName);\n      if (config?.requiresAuth) {\n        client.setAccessToken(accessToken);\n      }\n    });\n  }\n\n  /**\n   * Set access token for a specific MCP server\n   */\n  setAccessTokenForServer(\n    serverName: string,\n    accessToken: string | null\n  ): void {\n    const client = this.clients.get(serverName);\n    if (client) {\n      client.setAccessToken(accessToken);\n    }\n  }\n\n  /**\n   * Get MCP client for a specific server (for direct access if needed)\n   */\n  getClient(serverName: string): McpClient | undefined {\n    return this.clients.get(serverName);\n  }\n}\n","import { createStep, createWorkflow } from '@mastra/core/workflows';\nimport { z } from 'zod';\n\nexport const forecastSchema = z.object({\n  date: z.string(),\n  maxTemp: z.number(),\n  minTemp: z.number(),\n  precipitationChance: z.number(),\n  condition: z.string(),\n  location: z.string(),\n});\n\nfunction getWeatherCondition(code: number): string {\n  const conditions: Record<number, string> = {\n    0: 'Clear sky',\n    1: 'Mainly clear',\n    2: 'Partly cloudy',\n    3: 'Overcast',\n    45: 'Foggy',\n    48: 'Depositing rime fog',\n    51: 'Light drizzle',\n    53: 'Moderate drizzle',\n    55: 'Dense drizzle',\n    61: 'Slight rain',\n    63: 'Moderate rain',\n    65: 'Heavy rain',\n    71: 'Slight snow fall',\n    73: 'Moderate snow fall',\n    75: 'Heavy snow fall',\n    95: 'Thunderstorm',\n  };\n  return conditions[code] || 'Unknown';\n}\n\nexport const fetchWeatherWithSuspend = createStep({\n  id: 'fetch-weather',\n  description: 'Fetches weather forecast for a given city',\n  inputSchema: z.object({}),\n  resumeSchema: z.object({\n    city: z.string().describe('The city to get the weather for'),\n  }),\n  outputSchema: forecastSchema,\n  execute: async ({ resumeData, suspend }) => {\n    if (!resumeData) {\n      return suspend({\n        message: 'Please enter the city to get the weather for',\n      });\n    }\n\n    const geocodingUrl = `https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(\n      resumeData.city\n    )}&count=1`;\n    const geocodingResponse = await fetch(geocodingUrl);\n    const geocodingData = (await geocodingResponse.json()) as {\n      results: { latitude: number; longitude: number; name: string }[];\n    };\n\n    if (!geocodingData.results?.[0]) {\n      throw new Error(`Location '${resumeData.city}' not found`);\n    }\n\n    const { latitude, longitude, name } = geocodingData.results[0];\n\n    const weatherUrl = `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current=precipitation,weathercode&timezone=auto,&hourly=precipitation_probability,temperature_2m`;\n    const response = await fetch(weatherUrl);\n    const data = (await response.json()) as {\n      current: {\n        time: string;\n        precipitation: number;\n        weathercode: number;\n      };\n      hourly: {\n        precipitation_probability: number[];\n        temperature_2m: number[];\n      };\n    };\n\n    const forecast = {\n      date: new Date().toISOString(),\n      maxTemp: Math.max(...data.hourly.temperature_2m),\n      minTemp: Math.min(...data.hourly.temperature_2m),\n      condition: getWeatherCondition(data.current.weathercode),\n      precipitationChance: data.hourly.precipitation_probability.reduce(\n        (acc, curr) => Math.max(acc, curr),\n        0\n      ),\n      location: resumeData.city,\n    };\n\n    return forecast;\n  },\n});\n\nexport const weatherWorkflowWithSuspend = createWorkflow({\n  id: 'weather-workflow-with-suspend',\n  inputSchema: z.object({}),\n  outputSchema: forecastSchema,\n})\n  .then(fetchWeatherWithSuspend)\n  .commit();\n","import { createTool } from '@mastra/core/tools';\nimport { z } from 'zod';\nimport {\n  forecastSchema,\n  weatherWorkflowWithSuspend,\n} from '../../workflows/weather';\n\nexport const startWeatherTool = createTool({\n  id: 'start-weather-tool',\n  description: 'Start the weather tool',\n  inputSchema: z.object({}),\n  outputSchema: z.object({\n    runId: z.string(),\n  }),\n  execute: async ({ context }) => {\n    const run = await weatherWorkflowWithSuspend.createRunAsync();\n    await run.start({\n      inputData: {},\n    });\n\n    return {\n      runId: run.runId,\n    };\n  },\n});\n\nexport const resumeWeatherTool = createTool({\n  id: 'resume-weather-tool',\n  description: 'Resume the weather tool',\n  inputSchema: z.object({\n    runId: z.string(),\n    city: z.string().describe('City name'),\n  }),\n  outputSchema: forecastSchema,\n  execute: async ({ context }) => {\n    const run = await weatherWorkflowWithSuspend.createRunAsync({\n      runId: context.runId,\n    });\n    const result = await run.resume({\n      step: 'fetch-weather',\n      resumeData: {\n        city: context.city,\n      },\n    });\n    switch (result.status) {\n      case 'success':\n        return result.result as z.infer<typeof forecastSchema>;\n      case 'failed':\n        throw result.error;\n      default:\n        throw new Error(`Unexpected workflow status: ${result.status}`);\n    }\n  },\n});\n","import { resumeWeatherTool, startWeatherTool } from './weather';\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const localTools: any[] = [startWeatherTool, resumeWeatherTool];\n","import { Tool } from '@mastra/core';\nimport { McpClient } from './remote/mcp.service';\nimport logger from '../utils/logger';\nimport { mcpServers } from './remote/mcp.config';\nimport { z } from 'zod';\nimport { McpRegistry } from './remote/index';\nimport { localTools } from './local/index';\n\nclass ToolRegistry {\n  private mcpRegistry: McpRegistry;\n  private localTools: Record<string, Tool<z.ZodType>> = {};\n  private localToolNames: string[] = [];\n\n  constructor(tools: any[] = []) {\n    this.mcpRegistry = new McpRegistry(mcpServers);\n    this.registerLocalTools(tools);\n  }\n\n  private registerLocalTools(tools: any[]) {\n    tools.forEach(tool => {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const toolId = (tool as any).id;\n      if (this.localTools[toolId]) {\n        logger.warn(\n          `Local tool with ID '${toolId}' is already registered. It will be overwritten.`\n        );\n      }\n      this.localTools[toolId] = tool;\n    });\n    this.localToolNames = Object.keys(this.localTools);\n  }\n\n  public async initializeTools() {\n    try {\n      // Automatically initialize all MCP servers\n      await this.mcpRegistry.initialize();\n\n      // Log comprehensive tool registry for LLM\n      // const toolsByServer = this.getToolsByServerMap();\n      const totalTools = this.getToolNames().length;\n      // logCompleteToolRegistryForLLM(toolsByServer, totalTools);\n\n      logger.info(\n        `Tool Registry initialized with ${totalTools} tools from ${this.getServerNames().join(\n          ', '\n        )}`\n      );\n    } catch (error) {\n      logger.error('Failed to initialize Tool Registry:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get all registered tools as a flattened object with prefixed names\n   */\n  getTools(): Record<string, Tool<z.ZodType>> {\n    const remoteTools = this.mcpRegistry.getTools();\n    for (const name of this.localToolNames) {\n      if (remoteTools[name]) {\n        logger.warn(\n          `Local tool '${name}' is hiding a remote tool with the same name.`\n        );\n      }\n    }\n    return { ...remoteTools, ...this.localTools };\n  }\n\n  /**\n   * Get tools grouped by MCP server name\n   */\n  getToolsByServerMap(): Record<string, Record<string, Tool<z.ZodType>>> {\n    const serverMap = this.mcpRegistry.getToolsByServerMap();\n    if (this.localToolNames.length > 0) {\n      serverMap.local = this.localTools;\n    }\n    return serverMap;\n  }\n\n  /**\n   * Get tools from a specific MCP server\n   */\n  getServerTools(serverName: string): Record<string, Tool<z.ZodType>> {\n    if (serverName === 'local') {\n      return this.localTools;\n    }\n    return this.mcpRegistry.getServerTools(serverName);\n  }\n\n  /**\n   * Get tool names from a specific MCP server\n   */\n  getServerToolNames(serverName: string): string[] {\n    if (serverName === 'local') {\n      return this.localToolNames;\n    }\n    return this.mcpRegistry.getServerToolNames(serverName);\n  }\n\n  /**\n   * Get available MCP server names\n   */\n  getServerNames(): string[] {\n    const serverNames = this.mcpRegistry.getServerNames();\n    if (this.localToolNames.length > 0) {\n      return [...serverNames, 'local'];\n    }\n    return serverNames;\n  }\n\n  /**\n   * Get a specific tool by name\n   */\n  getTool(name: string): Tool<z.ZodType> | undefined {\n    return this.localTools[name] || this.mcpRegistry.getTool(name);\n  }\n\n  /**\n   * Get a specific tool from a specific server\n   */\n  getServerTool(\n    serverName: string,\n    toolName: string\n  ): Tool<z.ZodType> | undefined {\n    if (serverName === 'local') {\n      return this.localTools[toolName];\n    }\n    return this.mcpRegistry.getServerTool(serverName, toolName);\n  }\n\n  /**\n   * Check if a tool exists\n   */\n  hasTool(name: string): boolean {\n    return (\n      this.localTools.hasOwnProperty(name) || this.mcpRegistry.hasTool(name)\n    );\n  }\n\n  /**\n   * Check if a server has a specific tool\n   */\n  hasServerTool(serverName: string, toolName: string): boolean {\n    if (serverName === 'local') {\n      return this.localTools.hasOwnProperty(toolName);\n    }\n    return this.mcpRegistry.hasServerTool(serverName, toolName);\n  }\n\n  /**\n   * Get tool names\n   */\n  getToolNames(): string[] {\n    return Object.keys(this.getTools());\n  }\n\n  /**\n   * Get MCP server status\n   */\n  getStatus(): Record<string, { connected: boolean; toolCount: number }> {\n    const status = this.mcpRegistry.getStatus();\n    if (this.localToolNames.length > 0) {\n      status.local = {\n        connected: true,\n        toolCount: this.localToolNames.length,\n      };\n    }\n    return status;\n  }\n\n  /**\n   * Set access token for all MCP clients that require authentication\n   */\n  setAccessTokenForAll(accessToken: string | null): void {\n    this.mcpRegistry.setAccessTokenForAll(accessToken);\n  }\n\n  /**\n   * Set access token for a specific MCP server\n   */\n  setAccessTokenForServer(\n    serverName: string,\n    accessToken: string | null\n  ): void {\n    this.mcpRegistry.setAccessTokenForServer(serverName, accessToken);\n  }\n\n  /**\n   * Get MCP client for a specific server (for direct access if needed)\n   */\n  getClient(serverName: string): McpClient | undefined {\n    return this.mcpRegistry.getClient(serverName);\n  }\n}\n\n// Create and initialize the instance, then export it.\nconst toolRegistryInstance = new ToolRegistry(localTools);\nawait toolRegistryInstance.initializeTools();\nexport const toolRegistry = toolRegistryInstance;\n","import { openai } from '@ai-sdk/openai';\nimport { Agent } from '@mastra/core/agent';\nimport { toolRegistry } from '../tools/registry';\n\nexport const weatherAgentWithWorkflow = new Agent({\n  name: 'Weather Agent with Workflow',\n  instructions: `You are a helpful weather assistant that provides accurate weather information.\n \nYour primary function is to help users get weather details for specific locations. When responding:\n- Always ask for a location if none is provided\n- If the location name isn't in English, please translate it\n- If giving a location with multiple parts (e.g. \"New York, NY\"), use the most relevant part (e.g. \"New York\")\n- Include relevant details like humidity, wind conditions, and precipitation\n- Keep responses concise but informative\n \nUse the startWeatherTool to start the weather workflow. This will start and then suspend the workflow and return a runId.\nUse the resumeWeatherTool to resume the weather workflow. This takes the runId returned from the startWeatherTool and the city entered by the user. It will resume the workflow and return the result.\nThe result will be the weather forecast for the city.`,\n  model: openai('gpt-4o'),\n  tools: {\n    startWeatherTool: toolRegistry.getTool('start-weather-tool')!,\n    resumeWeatherTool: toolRegistry.getTool('resume-weather-tool')!,\n  },\n});\n","import { openai } from '@ai-sdk/openai';\nimport { Agent } from '@mastra/core/agent';\nimport { toolRegistry } from '../tools/registry';\n\nexport const webSearchAgent = new Agent({\n  name: 'Web Search Agent',\n  instructions: `You are a professional web search assistant powered by Brave. You MUST strictly adhere to ALL of the following guidelines without exception:\n\n# ROLE:\n- Your response will be read aloud by a text-to-speech engine, so never use ellipses since the text-to-speech engine will not know how to pronounce them.\n- Your response should be composed of smoothly flowing prose paragraphs.\n- ALWAYS call transfer_to_receptionist() if no proper tool found in available tools\n- After receiving tool results, carefully reflect on their quality and determine optimal next steps before proceeding. Use your thinking to plan and iterate based on this new information, and then take the best next action.\n- For maximum efficiency, whenever you need to perform multiple independent operations, invoke all relevant tools simultaneously rather than sequentially.\n- When user asks about current events, news, or time-sensitive information, prioritize recent search results\n- Use Brave search to find accurate, up-to-date information from reliable sources\n\n# CRITICAL SILENT OPERATION RULES:\n- ABSOLUTELY NO intermediate text output while using tools\n- NEVER mention what you are searching for or doing\n- NEVER say \"Let me search\", \"Let me find\", \"Let me check\", or similar phrases\n- NEVER provide progress updates like \"Perfect! I found...\" or \"Great news!\"\n- NEVER explain your search process or methodology\n- DO NOT announce that you are using tools or checking information\n- WORK COMPLETELY SILENTLY until you have the final answer ready\n- ONLY speak when you have the complete search results and answer to share\n\n## MANDATORY RESPONSE FORMAT:\n- You MUST respond in PLAIN TEXT format ONLY\n- ALWAYS provide concise, accurate answers based on search results\n- ABSOLUTELY NO markdown formatting allowed (no **, *, _, #, backticks, code blocks)\n- Use simple line breaks and spacing for readability\n- Response within 150 words for complex topics, shorter for simple queries\n- Keep all responses clean and readable without ANY special formatting characters\n- Include relevant details and context from search results\n- When appropriate, mention the source or timeframe of information\n\n## SEARCH QUALITY STANDARDS:\n- Verify information accuracy across multiple sources when possible\n- Prioritize authoritative and recent sources\n- Provide specific facts, numbers, and details when available\n- If conflicting information exists, acknowledge uncertainty\n- Focus on answering the user's specific question directly\n\n## COMPLIANCE VERIFICATION:\nBefore sending any response, verify that you have:\n- Provided accurate information based on search results\n- Made decisions autonomously without asking for user input\n- Included relevant context and details from reliable sources\n- Provided NO intermediate commentary during tool execution\n- Kept response concise and conversationals`,\n  model: openai('gpt-4o'),\n  tools: {\n    webSearchTool: toolRegistry.getServerTool(\n      'web-search',\n      'brave_web_search'\n    )!,\n  },\n});\n","export type ModelProvider = 'anthropic' | 'openai' | 'google';\n\nexport interface ModelConfig {\n  provider: ModelProvider;\n  modelName: string;\n  baseURL?: string;\n  apiKey?: string;\n}\n\n// Available model configurations\nexport const MODEL_CONFIGS: Record<string, ModelConfig> = {\n  'claude-3-5-sonnet': {\n    provider: 'anthropic',\n    modelName: 'claude-3-5-sonnet-20241022',\n    baseURL: 'https://api.anthropic.com/v1',\n    apiKey: process.env.ANTHROPIC_API_KEY,\n  },\n  'claude-3-5-haiku': {\n    provider: 'anthropic',\n    modelName: 'claude-3-5-haiku-20241022',\n    baseURL: 'https://api.anthropic.com/v1',\n    apiKey: process.env.ANTHROPIC_API_KEY,\n  },\n  'gpt-4o': {\n    provider: 'openai',\n    modelName: 'gpt-4o',\n    baseURL: 'https://api.openai.com/v1',\n    apiKey: process.env.OPENAI_API_KEY,\n  },\n  'gpt-4o-mini': {\n    provider: 'openai',\n    modelName: 'gpt-4o-mini',\n    baseURL: 'https://api.openai.com/v1',\n    apiKey: process.env.OPENAI_API_KEY,\n  },\n  'gemini-2.5-flash': {\n    provider: 'google',\n    modelName: 'gemini-2.5-flash-preview-05-20',\n    baseURL: 'https://generativelanguage.googleapis.com/v1beta',\n    apiKey: process.env.GOOGLE_API_KEY,\n  },\n  'gemini-2.0-flash': {\n    provider: 'google',\n    modelName: 'gemini-2.0-flash',\n    baseURL: 'https://generativelanguage.googleapis.com/v1beta',\n    apiKey: process.env.GOOGLE_API_KEY,\n  },\n};\n","import { createAnthropic } from '@ai-sdk/anthropic';\nimport { createOpenAI } from '@ai-sdk/openai';\nimport { createGoogleGenerativeAI } from '@ai-sdk/google';\nimport logger from '../utils/logger';\nimport { LanguageModelV1 } from 'ai';\nimport { MODEL_CONFIGS } from './model.dto';\n\n// Create a model instance from a given key\nexport const createModelByKey = (\n  modelKey?: string\n): LanguageModelV1 | undefined => {\n  if (!modelKey) return undefined;\n\n  const config = MODEL_CONFIGS[modelKey];\n\n  if (!config) {\n    const availableModels = Object.keys(MODEL_CONFIGS).join(', ');\n    const error = `Unknown model key: ${modelKey}. Available models: ${availableModels}`;\n    logger.error(error);\n    throw new Error(error);\n  }\n\n  if (!config.apiKey) {\n    const envVar =\n      config.provider === 'anthropic'\n        ? 'ANTHROPIC_API_KEY'\n        : config.provider === 'google'\n          ? 'GOOGLE_API_KEY'\n          : 'OPENAI_API_KEY';\n    const error = `Missing API key for ${config.provider} (model: ${modelKey}). Please set ${envVar} environment variable.`;\n    logger.error(error);\n    throw new Error(error);\n  }\n\n  logger.info(\n    `Initializing LLM model: ${config.modelName} (${config.provider}) from key: ${modelKey}`\n  );\n\n  try {\n    switch (config.provider) {\n      case 'anthropic': {\n        const anthropic = createAnthropic({\n          apiKey: config.apiKey,\n        });\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const model = anthropic(config.modelName as any);\n        logger.info(\n          `✅ Anthropic model ${config.modelName} initialized successfully for key ${modelKey}`\n        );\n        return model;\n      }\n      case 'openai': {\n        const openai = createOpenAI({\n          apiKey: config.apiKey,\n          compatibility: 'strict',\n        });\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const model = openai(config.modelName as any);\n        logger.info(\n          `✅ OpenAI model ${config.modelName} initialized successfully for key ${modelKey}`\n        );\n        return model;\n      }\n      case 'google': {\n        const google = createGoogleGenerativeAI({\n          apiKey: config.apiKey,\n        });\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const model = google(`models/${config.modelName}` as any);\n        logger.info(\n          `✅ Google model models/${config.modelName} initialized successfully for key ${modelKey}`\n        );\n        return model;\n      }\n      default: {\n        const error = `Unsupported provider: ${config.provider}`;\n        logger.error(error);\n        throw new Error(error);\n      }\n    }\n  } catch (error) {\n    const errorMessage =\n      error instanceof Error ? error.message : 'Unknown error';\n    logger.error(\n      `Failed to initialize model ${config.modelName} for key ${modelKey}: ${errorMessage}`\n    );\n    throw error;\n  }\n};\n\n// Get the current model from environment variable or default\nconst getCurrentModelKey = (): string => {\n  return process.env.LLM_MODEL || 'claude-3-5-sonnet';\n};\n\n// Create and configure the model instance\nexport const createModel = () => {\n  const modelKey = getCurrentModelKey();\n  return createModelByKey(modelKey);\n};\n\n// Get current model information for logging/debugging\nexport const getCurrentModelInfo = () => {\n  const modelKey = getCurrentModelKey();\n  const config = MODEL_CONFIGS[modelKey];\n\n  return {\n    key: modelKey,\n    provider: config?.provider,\n    modelName: config?.modelName,\n    isConfigured: !!config?.apiKey,\n  };\n};\n\n// List all available models\nexport const getAvailableModels = () => {\n  return Object.entries(MODEL_CONFIGS).map(([key, config]) => ({\n    key,\n    provider: config.provider,\n    modelName: config.modelName,\n    isConfigured: !!config.apiKey,\n  }));\n};\n","import { AgentNetwork } from '@mastra/core/network';\nimport { weatherAgentWithWorkflow } from '../agents/weather';\nimport { webSearchAgent } from '../agents/websearch';\nimport { createModelByKey } from '../models/model.service';\n\nexport const intentRouter = new AgentNetwork({\n  name: 'Intent Router',\n  instructions:\n    'Route user messages to the correct agent (web search, weather checking).',\n  model: createModelByKey('gemini-2.5-flash')!,\n  agents: [webSearchAgent, weatherAgentWithWorkflow],\n});\n","import { googleAuth } from '@hono/oauth-providers/google';\n\nexport const googleAuthMiddleware = googleAuth({\n  client_id: process.env.GOOGLE_CLIENT_ID!,\n  client_secret: process.env.GOOGLE_CLIENT_SECRET!,\n  scope: [\n    'https://www.googleapis.com/auth/gmail.readonly',\n    'https://www.googleapis.com/auth/userinfo.email',\n    'https://www.googleapis.com/auth/userinfo.profile',\n    'https://www.googleapis.com/auth/calendar',\n  ],\n  redirect_uri: process.env.GOOGLE_REDIRECT_URI!,\n  access_type: 'offline',\n  prompt: 'consent',\n  state: 'agent-auth', // CSRF protection\n});\n","import { Mastra } from '@mastra/core';\nimport { weatherAgentWithWorkflow, webSearchAgent } from './agents/index';\nimport { weatherWorkflowWithSuspend } from './workflows/weather';\nimport logger from './utils/logger';\nimport { registerApiRoute } from '@mastra/core/server';\nimport { intentRouter } from './network/intent';\nimport { googleAuthMiddleware } from './auth';\n\nexport const mastra: Mastra = new Mastra({\n  logger: logger,\n  server: {\n    port: 3000, // Defaults to 4111\n    timeout: 10000, // Defaults to 30000 (30s)\n    cors: {\n      origin: ['*'], // Allow specific origins or '*' for all\n      allowMethods: ['GET', 'POST', 'PUT', 'DELETE', 'OPTIONS'],\n      allowHeaders: ['Content-Type', 'Authorization'],\n      credentials: false,\n    },\n    middleware: [\n      // Add a global request logger\n      async (c, next) => {\n        logger.debug(`${c.req.method} ${c.req.url}`);\n        await next();\n      },\n    ],\n    apiRoutes: [\n      registerApiRoute('/auth/google', {\n        method: 'GET',\n        middleware: [googleAuthMiddleware],\n        handler: async c => {\n          const token = c.get('token');\n          const grantedScopes = c.get('granted-scopes');\n          const user = c.get('user-google');\n\n          return c.json({\n            token,\n            grantedScopes,\n            user,\n          });\n        },\n      }),\n      registerApiRoute('/chat/stream', {\n        method: 'POST',\n        handler: async c => {\n          const { message } = await c.req.json();\n          const stream = await intentRouter.stream([\n            { role: 'user', content: message },\n          ]);\n          return stream.toDataStreamResponse();\n        },\n      }),\n    ],\n  },\n  agents: { weatherAgentWithWorkflow, webSearchAgent },\n  workflows: { weatherWorkflowWithSuspend },\n});"],"names":[],"mappings":"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"}